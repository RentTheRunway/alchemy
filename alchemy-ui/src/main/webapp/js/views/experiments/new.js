// Generated by CoffeeScript 1.7.1
(function() {
  define(['jquery', 'underscore', 'backbone', 'libs/text!templates/experiments/_new.html', 'models/experiment', 'views/experiments/show'], function($, _, Backbone, newFormTemplate, Experiment, ShowView) {
    var NewFormView;
    return NewFormView = Backbone.View.extend({
      tagName: 'div',
      className: 'new-form container',
      template: _.template(newFormTemplate),
      events: {
        'submit form': 'submitNewExperiment'
      },
      render: function() {
        $('.js-page-title').text('Create a New Experiment');
        $('.js-page-subtitle').text('Please fill all required* fields');
        this.$el.html(this.template());
        return this;
      },
      submitNewExperiment: function(e) {
        var $form, description, formData, name, newExperiment;
        e.preventDefault();
        $form = $(e.currentTarget);
        formData = $form.serializeArray();
        name = _.find(formData, function(element) {
          return element.name === "experiment-name";
        }).value;
        description = _.find(formData, function(element) {
          return element.name === "experiment-description";
        }).value;
        newExperiment = new Experiment({
          name: name,
          description: description
        });
        this.model = newExperiment;
        return newExperiment.sync("update", newExperiment, {
          url: "/api/experiments",
          complete: (function(_this) {
            return function(jqXHR, textStatus) {
              if (jqXHR.status === 201) {
                return window.location.href = "#experiments/" + (_this.model.get('name'));
              } else {

              }
            };
          })(this)
        });
      }
    });
  });

}).call(this);
